id: cb23d6cb-4b2e-44a7-b48e-040dd043147b
name: 1Password - Vault export
version: 1.0.0
kind: Scheduled
description: |-
  This will alert when a successful vault export has occurred within 1Password.

  Ref: https://1password.com/
  Ref: https://github.com/securehats/
severity: Low
queryFrequency: 1h
queryPeriod: 1h
triggerOperator: gt
triggerThreshold: 0
tactics:
- CredentialAccess
relevantTechniques:
- T1555
query: |-
  OnePasswordEventLogs_CL
  | where action == "export" and object_type == "vault"
  | extend
      TargetUsername = actor_details.email
      , SrcIpAddr = session.ip
suppressionEnabled: false
incidentConfiguration:
  createIncident: true
  groupingConfiguration:
    enabled: false
    reopenClosedIncident: false
    lookbackDuration: 5h
    matchingMethod: AllEntities
    groupByEntities: []
    groupByAlertDetails: []
    groupByCustomDetails: []
eventGroupingSettings:
  aggregationKind: SingleAlert
entityMappings:
- entityType: Account
  fieldMappings:
  - identifier: FullName
    columnName: TargetUsername
- entityType: IP
  fieldMappings:
  - identifier: Address
    columnName: SrcIpAddr
suppressionDuration: 5h

