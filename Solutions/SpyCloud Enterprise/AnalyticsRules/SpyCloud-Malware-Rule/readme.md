# SpyCloud Enterprise Malware Analytic Rule

![SpyCloud Enterprise](images/logo.png)

## Table of Contents

1. [Overview](#overview)
2. [Prerequisites](#prerequisites)
3. [Deployment](#deployment)
4. [Post Deployment Steps](#postdeployment)


<a name="overview">

## Overview
This analytic rule will monitor the SpyCloud watchlist custom log table. This rule will trigger an incident when a record with severity 25 is found. All the details of the malware record are saved in entities and custom details of the rule, that can be used in the playbooks for further investigation.


<a name="prerequisites">

## Prerequisites
- SpyCloud Enterprise Monitor Watchlist Data playbook needs to be deployed and successfully run prior to the deployment of this analytic rule, in the same resource group and region. Relevant instructions can be found on the playbook document page.
- SpyCloud Enterprise Monitor Watchlist Data playbook needs to be succesfully completed and it should create the custom log table in the Log Analytics Workaspace.
- SpyCloud Enterprise Malware Playbook needs to be deployed prior to the deployment of this analytic rule, in the same resource group and region. Relevant instructions can be found on the playbook document page.

<a name="deployment">

## Deployment instructions
- Deploy the analytic rule by clicking on "Deploy to Azure" button. This will take you to deploy an ARM Template wizard.
- Fill in the required parameters for deploying the playbook.
  ![deployment](images/deployment.png)
- Click "Review + create". Once the validation is successful, click on "Create".

[![Deploy to Azure](https://aka.ms/deploytoazurebutton)](https://portal.azure.com/#create/Microsoft.Template/uri/https%3A%2F%2Fraw.githubusercontent.com%2FRamboV%2FAzure-Sentinel%2Fmaster%2FSolutions%2FSpyCloud%20Enterprise%2FAnalyticsRules%2FSpyCloud-Malware-Rule%2Fazuredeploy.json)
[![Deploy to Azure Gov](https://aka.ms/deploytoazuregovbutton)](https://portal.azure.us/#create/Microsoft.Template/uri/https%3A%2F%2Fraw.githubusercontent.com%2FRamboV%2FAzure-Sentinel%2Fmaster%2FSolutions%2FSpyCloud%20Enterprise%2FAnalyticsRules%2FSpyCloud-Malware-Rule%2Fazuredeploy.json)

<a name="postdeployment">

## Post-Deployment instructions
### Automate Response 
- In the Automated response of this analytic rule, please add an automation rule to trigger "SpyCloud Malware Playbook".

