{
    "version": "Notebook/1.0",
    "items": [
      {
        "type": 9,
        "content": {
          "version": "KqlParameterItem/1.0",
          "parameters": [
            {
              "id": "9875bc24-f51c-4151-96f0-2e4af7039364",
              "version": "KqlParameterItem/1.0",
              "name": "Time",
              "type": 4,
              "typeSettings": {
                "selectableValues": [
                  {
                    "durationMs": 1800000
                  },
                  {
                    "durationMs": 3600000
                  },
                  {
                    "durationMs": 14400000
                  },
                  {
                    "durationMs": 86400000
                  },
                  {
                    "durationMs": 604800000
                  }
                ],
                "allowCustom": true
              },
              "timeContext": {
                "durationMs": 86400000
              },
              "value": {
                "durationMs": 604800000
              }
            }
          ],
          "style": "above",
          "queryType": 0,
          "resourceType": "microsoft.operationalinsights/workspaces"
        },
        "name": "parameters - 5"
      },
      {
        "type": 12,
        "content": {
          "version": "NotebookGroup/1.0",
          "groupType": "editable",
          "items": [
            {
              "type": 3,
              "content": {
                "version": "KqlItem/1.0",
                "query": "table('Illumio_Auditable_Events_CL')\n| where event_type == 'agent.tampering'\n| summarize count()",
                "size": 4,
                "title": "Tampering events",
                "noDataMessage": "0",
                "timeContextFromParameter": "Time",
                "queryType": 0,
                "resourceType": "microsoft.operationalinsights/workspaces",
                "visualization": "card",
                "textSettings": {
                  "style": "bignumber"
                }
              },
              "customWidth": "30",
              "name": "Tampering events",
              "styleSettings": {
                "maxWidth": "30"
              }
            },
            {
              "type": 3,
              "content": {
                "version": "KqlItem/1.0",
                "query": "table('Illumio_Auditable_Events_CL')\n| summarize count()",
                "size": 4,
                "title": "Audit Events",
                "timeContextFromParameter": "Time",
                "queryType": 0,
                "resourceType": "microsoft.operationalinsights/workspaces",
                "visualization": "card",
                "tileSettings": {
                  "showBorder": false
                },
                "textSettings": {
                  "style": "bignumber"
                }
              },
              "customWidth": "30",
              "name": "Audit Events",
              "styleSettings": {
                "maxWidth": "30"
              }
            },
            {
              "type": 3,
              "content": {
                "version": "KqlItem/1.0",
                "query": "table('Illumio_Auditable_Events_CL')\n| where event_type == 'port_scan'\n| summarize count()",
                "size": 4,
                "title": "Port Scan Events",
                "timeContextFromParameter": "Time",
                "queryType": 0,
                "resourceType": "microsoft.operationalinsights/workspaces",
                "visualization": "card",
                "textSettings": {
                  "style": "bignumber"
                }
              },
              "customWidth": "30",
              "name": "Port Scan Events",
              "styleSettings": {
                "maxWidth": "30"
              }
            }
          ]
        },
        "name": "group - 5"
      },
      {
        "type": 3,
        "content": {
          "version": "KqlItem/1.0",
          "query": "table('Illumio_Auditable_Events_CL')\n| summarize distinct_count = dcount(href) by event_type\n| order by distinct_count \n| top 10 by distinct_count",
          "size": 0,
          "title": "Top Auditable events",
          "timeContextFromParameter": "Time",
          "queryType": 0,
          "resourceType": "microsoft.operationalinsights/workspaces",
          "visualization": "categoricalbar"
        },
        "name": "query - 0"
      },
      {
        "type": 3,
        "content": {
          "version": "KqlItem/1.0",
          "query": "table('Illumio_Auditable_Events_CL')\n| summarize arg_max(TimeGenerated, *) by href\n| where event_type == 'workloads.update'\n| mv-expand resource_change = resource_changes\n| project TimeGenerated,\n          vm_hostname = resource_change.resource.workload.hostname,\n          enf_mode_before = resource_change.changes.enforcement_mode.before,\n          enf_mode_after = resource_change.changes.enforcement_mode.after,\n          user = created_by.user.username\n| where isnotnull(vm_hostname)     \n          \n\n",
          "size": 1,
          "title": "Workload enforcement mode updates",
          "timeContextFromParameter": "Time",
          "queryType": 0,
          "resourceType": "microsoft.operationalinsights/workspaces"
        },
        "name": "Workload enforcement mode updates"
      },
      {
        "type": 3,
        "content": {
          "version": "KqlItem/1.0",
          "query": "table('Illumio_Auditable_Events_CL')\n| summarize arg_max(TimeGenerated, *) by href // try to filter what event_type to prioritize in bar chart\n| make-series events = count() default = 0 on TimeGenerated from {Time:start} to {Time:end} step 1h by event_type //from ago(1d) to now() step 1h by event_type ",
          "size": 0,
          "title": "PCE events breakdown - every hour",
          "timeContextFromParameter": "Time",
          "queryType": 0,
          "resourceType": "microsoft.operationalinsights/workspaces",
          "visualization": "unstackedbar",
          "tileSettings": {
            "showBorder": false
          },
          "graphSettings": {
            "type": 0
          },
          "mapSettings": {
            "locInfo": "LatLong"
          }
        },
        "name": "PCE events breakdown - every hour"
      }
    ],
    "fallbackResourceIds": [
      "/subscriptions/9c26c390-3311-4d6d-8f3c-4a240151e956/resourcegroups/ashwin.venkatesha-rg/providers/microsoft.operationalinsights/workspaces/testla"
    ],
    "fromTemplateId": "sentinel-IllumioAuditableEventsWorkbook",
    "$schema": "https://github.com/Microsoft/Application-Insights-Workbooks/blob/master/schema/workbook.json"
  }