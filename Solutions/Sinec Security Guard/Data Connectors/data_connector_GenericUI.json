{
    "type": "Microsoft.SecurityInsights/dataConnectors",
    "apiVersion": "2023-01-01",
    "name": "SINECSecurityGuard",
    "kind": "GenericUI",
    "properties": {
        "connectorUiConfig": {
            "id": "SINECSecurityGuard",
            "title": "Sinec Security Guard Security Events",
            "publisher": "Siemens AG",
            "descriptionMarkdown": "The Sinec Security Guard solution for Microsoft Sentinel allows you to ingest security events of your industrial networks from the (SINEC Security Guard)[https://siemens.com/sinec-security-guard] into Azure Sentinel",
            "graphQueriesTableName": "SINECSecurityGuard_CL",
            "availability": {
                "isPreview": true,
                "status": 1
            },
            "connectivityCriterias": [
                {
                    "type": "IsConnectedQuery",
                    "value": "{{graphQueriesTableName}}\n | summarize lastLogGenerated = max(TimeGenerated) | project IsConnected = lastLogGenerated > ago(30d)"
                }
            ],
            "dataTypes": [
                {
                    "name": "{{graphQueriesTableName}}",
                    "lastDataReceivedQuery": "{{graphQueriesTableName}}\n | summarize Time = max(TimeGenerated) | where isnotempty(Time)"
                }
            ],
            "graphQueries": [
                {
                    "metricName": "Total events received",
                    "legend": "",
                    "baseQuery": "{{graphQueriesTableName}}\n | summarize count()"
                }
            ],
            "sampleQueries": [
                {
                    "description": "List of Attacks",
                    "query": "{{graphQueriesTableName}}\n | summarize count()"
                }
            ],
            "instructionSteps": [
                {
                    "description": "This Data Connector relies on the SINEC Security Guard Sensor Package to be able to receive Sensor events in Microsoft Sentinel. The Sensor Package can be purchased in the Siemens Xcelerator Marketplace.",
                    "instructions": [
                        {
                            "parameters": {
                                "title": "1. Please follow the steps to configure the data connector",
                                "instructionSteps": [
                                    {
                                        "title": "Set up the SINEC Security Guard Sensor",
                                        "description": ""
                                    },
                                    {
                                        "title": "Create the Data Connector and configure it in the SINEC Security Guard web interface",
                                        "description": ""
                                    }
                                ]
                            },
                            "type": "InstructionStepsGroup"
                        }
                    ]
                }
            ],
            "permissions": {
                "resourceProvider": [
                    {
                        "provider": "Microsoft.OperationalInsights/workspaces",
                        "permissionsDisplayText": "read and write permissions are required.",
                        "providerDisplayName": "Workspace",
                        "scope": "Workspace",
                        "requiredPermissions": {
                            "write": true,
                            "read": true,
                            "delete": true
                        }
                    }
                ]
            }
        }
    }
}
