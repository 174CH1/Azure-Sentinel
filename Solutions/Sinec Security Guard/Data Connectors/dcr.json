{   
	"name": "SSGDCR",
	"apiVersion": "2023-01-01",
	"type": "Microsoft.Insights/dataCollectionRules",
	"location": "{{location}}",
	"properties": {
		"dataCollectionEndpointId": "{{dataCollectionEndpointId}}",
        "streamDeclarations": {
          "Custom-SINECSecurityGuard_CL": {
            "columns": [
              {
                "name": "sensor_id",
                "type": "string"
              },
              {
                "name": "sensor_name",
                "type": "string"
              },
              {
                "name": "tenant_id",
                "type": "string"
              },
              {
                "name": "detected_at",
                "type": "datetime"
              },
              {
                "name": "source_ip",
                "type": "string"
              },
              {
                "name": "source_port",
                "type": "int"
              },
              {
                "name": "destination_ip",
                "type": "string"
              },
              {
                "name": "destination_port",
                "type": "int"
              },
              {
                "name": "protocol",
                "type": "string"
              },
              {
                "name": "signature_id",
                "type": "int"
              },
              {
                "name": "signature_name",
                "type": "string"
              },
              {
                "name": "signature_category",
                "type": "string"
              },
              {
                "name": "severity",
                "type": "string"
              },
              {
                "name": "signature_details",
                "type": "string"
              },
              {
                "name": "evidence",
                "type": "dynamic"
              }
            ]
          }
		},
		"destinations": {
		  "logAnalytics": [
		    {
			  "workspaceResourceId": "{{workspaceResourceId}}",
			  "name": "ssgsensorlogs"
			}
		  ]
		},
		"dataFlows": [
		  {
		    "streams": [ "Custom-SINECSecurityGuard_CL"],
		    "destinations": ["ssgsensorlogs"],
		    "transformKql": "source | project TimeGenerated = todatetime([\"_created\"]), Username = username, ClientIP = client_ip, EventCategory = event_cat, EventId = event_id, Level = level, Message = tostring(message.en)",
		    "outputStream": "Custom-SINECSecurityGuard_CL"
		  }
        ]  
	}
}