id : f5e93f79-9e3c-4505-a52e-e634988a8bdb
Function:
  Title: Parser for CriblAudit
  Version: '1.0.0'
  LastUpdated: '2024-08-01'
Category: Microsoft Sentinel Parser
FunctionName: CriblAudit
FunctionAlias: CriblAudit
FunctionQuery: |
    Syslog
    | where Facility == 'local7'
    | where ProcessName == 'Cribl-Audit-logs'
    | extend parseMessage = parse_json(SyslogMessage)
    | project TimeGenerated,
      dataset = parsedMessage.dataset,
      _raw = parsedMessage._raw,
      source = parsedMessage.source,
      _time = parsedMessage._time,
      time = parsedMessage.time,
      action = parsedMessage.action,
      type = parsedMessage.type,
      user = parsedMessage.user,
      id = parsedMessage.id,
      version = parsedMessage.version,
      requestId = parsedMessage.requestId,
      cribl_breaker = parsedMessage.cribl_breaker,
      saas_domain = parsedMessage.saas_domain,
      tenantId = parsedMessage.tenantId,
      deployment = parsedMessage.deployment,
      workspace = parsedMessage.workspace,
      fleet = parsedMessage.fleet,
      instance = parsedMessage.instance,
      service = parsedMessage.service,
      sourceType = parsedMessage.sourceType,
      datatype = parsedMessage.datatype,
      data_source = parsedMessage.data_source