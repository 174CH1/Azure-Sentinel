Function:
  Title: Parser for CriblAccess
  Version: '1.0.0'
  LastUpdated: '2024-08-01'
Category: Microsoft Sentinel Parser
FunctionName: CriblAccess
FunctionAlias: CriblAccess
FunctionQuery: |
FunctionQuery: |
    Syslog
    | where Facility == 'local7'
    | where ProcessName == 'Cribl-Access-Logs'
    | where SyslogMessage has_any ("GET","POST","PUT","DELETE","PATCH") and SyslogMessage contains "HTTP"
    | parse SyslogMessage with IPAddress " - - [" EventTime "] \"" RequestVerb " " URI " " HTTPVersion "\"" ResponseCode " " BytesSent "\"" HTTPReferer "\" \"" UserAgent
    | project TimeGenerated, EventTime = todatetime(EventTime), IPAddress, RequestVerb, URI, HTTPVersion, ResponseCode, BytesSent, HTTPReferer, UserAgent