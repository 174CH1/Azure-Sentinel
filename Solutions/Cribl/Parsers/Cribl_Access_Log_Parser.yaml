Function:
  Title: Parser for CriblAudit
  Version: '1.0.0'
  LastUpdated: '2024-08-01'
Category: Microsoft Sentinel Parser
FunctionName: CriblAudit
FunctionAlias: CriblAccess
FunctionQuery: |
  CriblAudit_CL
  | extend
      dataset = extract('"dataset":"([^"]*)"', 1, RawData),
      _raw = extract('"_raw":"([^"]*)"', 1, RawData),
      source = extract('"source":"([^"]*)"', 1, RawData),
      _time = extract('"_time":"([^"]*)"', 1, RawData),
      time = extract('"time":"([^"]*)"', 1, RawData),
      src = extract('"src":"([^"]*)"', 1, RawData),
      method = extract('"method":"([^"]*)"', 1, RawData),
      url = extract('"url":"([^"]*)"', 1, RawData),
      status = extract('"status":"([^"]*)"', 1, RawData),
      message = extract('"message":"([^"]*)"', 1, RawData),
      response_time = extract('"response_time":"([^"]*)"', 1, RawData),
      requestId = extract('"requestId":"([^"]*)"', 1, RawData),
      cribl_breaker = extract('"cribl_breaker":"([^"]*)"', 1, RawData),
      saas_domain = extract('"saas_domain":"([^"]*)"', 1, RawData),
      tenantId = extract('"tenantId":"([^"]*)"', 1, RawData),
      deployment = extract('"deployment":"([^"]*)"', 1, RawData),
      workspace = extract('"workspace":"([^"]*)"', 1, RawData),
      fleet = extract('"fleet":"([^"]*)"', 1, RawData),
      instance = extract('"instance":"([^"]*)"', 1, RawData),
      service = extract('"service":"([^"]*)"', 1, RawData),
      sourceType = extract('"sourceType":"([^"]*)"', 1, RawData),
      datatype = extract('"datatype":"([^"]*)"', 1, RawData),
      data_source = extract('"data_source":"([^"]*)"', 1, RawData)
  | project-away RawData

Mappings:
  - Source:
      Field: RawData
    Destination:
      Fields:
        - dataset
        - _raw
        - source
        - _time
        - time
        - src
        - method
        - url
        - status
        - message
        - response_time
        - requestId
        - cribl_breaker
        - saas_domain
        - tenantId
        - deployment
        - workspace
        - fleet
        - instance
        - service
        - sourceType
        - datatype
        - data_source