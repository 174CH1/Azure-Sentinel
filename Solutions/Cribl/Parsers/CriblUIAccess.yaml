id: 8bc08089-197d-452e-bb5b-3bdf4b8a95b0
Function:
  Title: Parser for CriblUIAccess
  Version: '1.0.0'
  LastUpdated: '2024-08-01'
Category: Microsoft Sentinel Parser
FunctionName: CriblUIAccess
FunctionAlias: CriblAccess
FunctionQuery: |
    Syslog
    | where Facility == 'local7'
    | where ProcessName == 'Cribl-UIAccess-Logs'
    | where SyslogMessage has_any ("GET","POST","PUT","DELETE","PATCH") and SyslogMessage contains "HTTP"
    | parse SyslogMessage with IPAddress " - - [" EventTime "] \"" RequestVerb " " URI " " HTTPVersion "\"" ResponseCode " " BytesSent "\"" HTTPReferer "\" \"" UserAgent
    | project TimeGenerated, EventTime = todatetime(EventTime), IPAddress, RequestVerb, URI, HTTPVersion, ResponseCode, BytesSent, HTTPReferer, UserAgent