Function:
  Title: Parser for CriblUIAccess
  Version: '1.0.0'
  LastUpdated: '2024-08-01'
Category: Microsoft Sentinel Parser
FunctionName: CriblUIAccess
FunctionAlias: CriblAccess
FunctionQuery: |
  CriblUIAccess_CL
  | extend
      dataset = extract('"dataset":"([^"]*)"', 1, RawData),
      _raw = extract('"_raw":"([^"]*)"', 1, RawData),
      source = extract('"source":"([^"]*)"', 1, RawData),
      _time = extract('"_time":"([^"]*)"', 1, RawData),
      time = extract('"time":"([^"]*)"', 1, RawData),
      url = extract('"url":"([^"]*)"', 1, RawData),
      user = extract('"user":"([^"]*)"', 1, RawData),
      src = extract('"src":"([^"]*)"', 1, RawData),
      http_user_agent = extract('"http_user_agent":"([^"]*)"', 1, RawData),
      cribl_breaker = extract('"cribl_breaker":"([^"]*)"', 1, RawData),
      saas_domain = extract('"saas_domain":"([^"]*)"', 1, RawData),
      accountId = extract('"accountId":"([^"]*)"', 1, RawData),
      tenantId = extract('"tenantId":"([^"]*)"', 1, RawData),
      deployment = extract('"deployment":"([^"]*)"', 1, RawData),
      workspace = extract('"workspace":"([^"]*)"', 1, RawData),
      fleet = extract('"fleet":"([^"]*)"', 1, RawData),
      instance = extract('"instance":"([^"]*)"', 1, RawData),
      service = extract('"service":"([^"]*)"', 1, RawData),
      datatype = extract('"datatype":"([^"]*)"', 1, RawData),
      data_source = extract('"data_source":"([^"]*)"', 1, RawData)
  | project-away RawData

Mappings:
  - Source:
      Field: RawData
    Destination:
      Fields:
        - dataset
        - _raw
        - source
        - _time
        - time
        - url
        - user
        - src
        - http_user_agent
        - cribl_breaker
        - saas_domain
        - accountId
        - tenantId
        - deployment
        - workspace
        - fleet
        - instance
        - service
        - datatype
        - data_source