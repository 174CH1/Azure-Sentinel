Function:
  Title: Parser for CriblInternal
  Version: '1.0.0'
  LastUpdated: '2024-08-01'
Category: Microsoft Sentinel Parser
FunctionName: CriblInternal
FunctionAlias: CriblInternal
FunctionQuery: |
  CriblInternal_CL
  | extend
      dataset = extract('"dataset":"([^"]*)"', 1, RawData),
      _raw = extract('"_raw":"([^"]*)"', 1, RawData),
      source = extract('"source":"([^"]*)"', 1, RawData),
      _time = extract('"_time":"([^"]*)"', 1, RawData),
      time = extract('"time":"([^"]*)"', 1, RawData),
      cid = extract('"cid":"([^"]*)"', 1, RawData),
      channel = extract('"channel":"([^"]*)"', 1, RawData),
      level = extract('"level":"([^"]*)"', 1, RawData),
      message = extract('"message":"([^"]*)"', 1, RawData),
      cpuPerc = extract('"cpuPerc":([^,}]+)', 1, RawData),
      eluPerc = extract('"eluPerc":([^,}]+)', 1, RawData),
      mem_heap = extract('"mem":{[^}]*"heap":([^,}]+)', 1, RawData),
      mem_heapTotal = extract('"mem":{[^}]*"heapTotal":([^,}]+)', 1, RawData),
      mem_ext = extract('"mem":{[^}]*"ext":([^,}]+)', 1, RawData),
      mem_rss = extract('"mem":{[^}]*"rss":([^,}]+)', 1, RawData),
      mem_buffers = extract('"mem":{[^}]*"buffers":([^,}]+)', 1, RawData),
      cribl_breaker = extract('"cribl_breaker":"([^"]*)"', 1, RawData),
      saas_domain = extract('"saas_domain":"([^"]*)"', 1, RawData),
      accountId = extract('"accountId":"([^"]*)"', 1, RawData),
      tenantId = extract('"tenantId":"([^"]*)"', 1, RawData),
      deployment = extract('"deployment":"([^"]*)"', 1, RawData),
      workspace = extract('"workspace":"([^"]*)"', 1, RawData),
      fleet = extract('"fleet":"([^"]*)"', 1, RawData),
      instance = extract('"instance":"([^"]*)"', 1, RawData),
      service = extract('"service":"([^"]*)"', 1, RawData),
      datatype = extract('"datatype":"([^"]*)"', 1, RawData),
      data_source = extract('"data_source":"([^"]*)"', 1, RawData)
  | project-away RawData

Mappings:
  - Source:
      Field: RawData
    Destination:
      Fields:
        - dataset
        - _raw
        - source
        - _time
        - time
        - cid
        - channel
        - level
        - message
        - cpuPerc
        - eluPerc
        - mem_heap
        - mem_heapTotal
        - mem_ext
        - mem_rss
        - mem_buffers
        - cribl_breaker
        - saas_domain
        - accountId
        - tenantId
        - deployment
        - workspace
        - fleet
        - instance
        - service
        - datatype
        - data_source