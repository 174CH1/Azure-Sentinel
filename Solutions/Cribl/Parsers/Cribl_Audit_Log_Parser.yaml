Function:
  Title: Parser for CriblAudit
  Version: '1.0.0'
  LastUpdated: '2024-08-01'
Category: Microsoft Sentinel Parser
FunctionName: CriblAudit
FunctionAlias: CriblAudit
FunctionQuery: |
  CriblAudit_CL
  | extend 
      dataset = extract('"dataset":"([^"]*)"', 1, RawData),
      _raw = extract('"_raw":"([^"]*)"', 1, RawData),
      source = extract('"source":"([^"]*)"', 1, RawData),
      _time = extract('"_time":"([^"]*)"', 1, RawData),
      time = extract('"time":"([^"]*)"', 1, RawData),
      action = extract('"action":"([^"]*)"', 1, RawData),
      type = extract('"type":"([^"]*)"', 1, RawData),
      user = extract('"user":"([^"]*)"', 1, RawData),
      id = extract('"id":"([^"]*)"', 1, RawData),
      version = extract('"version":"([^"]*)"', 1, RawData),
      requestId = extract('"requestId":"([^"]*)"', 1, RawData),
      cribl_breaker = extract('"cribl_breaker":"([^"]*)"', 1, RawData),
      saas_domain = extract('"saas_domain":"([^"]*)"', 1, RawData),
      tenantId = extract('"tenantId":"([^"]*)"', 1, RawData),
      deployment = extract('"deployment":"([^"]*)"', 1, RawData),
      workspace = extract('"workspace":"([^"]*)"', 1, RawData),
      fleet = extract('"fleet":"([^"]*)"', 1, RawData),
      instance = extract('"instance":"([^"]*)"', 1, RawData),
      service = extract('"service":"([^"]*)"', 1, RawData),
      sourceType = extract('"sourceType":"([^"]*)"', 1, RawData),
      datatype = extract('"datatype":"([^"]*)"', 1, RawData),
      data_source = extract('"data_source":"([^"]*)"', 1, RawData)
  | project-away RawData

Mappings:
  - Source:
      Field: RawData
    Destination:
      Fields:
        - dataset
        - _raw
        - source
        - _time
        - time
        - action
        - type
        - user
        - id
        - version
        - requestId
        - cribl_breaker
        - saas_domain
        - tenantId
        - deployment
        - workspace
        - fleet
        - instance
        - service
        - sourceType
        - datatype
        - data_source